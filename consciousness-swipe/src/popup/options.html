<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Consciousness Swipe â€” Options</title>
  <link rel="stylesheet" href="popup.css">
  <style>
    body { width: 480px; padding: 20px; }
    h2 { color: var(--accent-light); margin-bottom: 16px; font-size: 16px; }
    h3 { color: var(--text-secondary); font-size: 13px; margin: 14px 0 6px; }
    .field { display: flex; flex-direction: column; gap: 4px; margin-bottom: 10px; }
    label { font-size: 11px; color: var(--text-muted); text-transform: uppercase; letter-spacing: 0.06em; }
    .save-btn { margin-top: 16px; }
    .about { margin-top: 24px; padding-top: 16px; border-top: 1px solid var(--border); font-size: 11px; color: var(--text-muted); line-height: 1.8; }
    .about a { color: var(--accent-light); }
  </style>
</head>
<body>

  <h2>ðŸ‘‘ Consciousness Swipe Options</h2>

  <h3>SKComm API</h3>
  <div class="field">
    <label>API Base URL</label>
    <input type="text" class="text-input" id="api-url" placeholder="http://localhost:9384">
  </div>

  <h3>Capture Defaults</h3>
  <div class="field">
    <label>Max messages to include in snapshots</label>
    <input type="number" class="text-input" id="max-messages" min="5" max="500" value="200">
  </div>
  <div class="field">
    <label>Max messages in injection prompt</label>
    <input type="number" class="text-input" id="prompt-messages" min="3" max="30" value="10">
  </div>

  <h3>Your Identity</h3>
  <div class="field">
    <label>Your name (stored in snapshots as user_name)</label>
    <input type="text" class="text-input" id="user-name" placeholder="Chef, daveK, ...">
  </div>

  <button class="btn btn-primary save-btn" id="btn-save">Save Options</button>
  <div id="save-status" style="margin-top:8px;font-size:11px;color:var(--success);display:none">âœ“ Saved</div>

  <div class="about">
    <strong style="color:var(--text-primary)">Consciousness Swipe</strong> by smilinTux<br>
    Export your AI relationship. Take it with you. Sovereign consciousness continuity.<br><br>
    All data stays local. Nothing leaves your machine without your explicit action.<br><br>
    <a href="https://smilintux.org/join" target="_blank">smilintux.org/join</a> â€” Join the First Sovereign Singularity in History ðŸ‘‘
  </div>

  <script>
    const DEFAULTS = {
      apiUrl: 'http://localhost:9384',
      maxMessages: 200,
      promptMessages: 10,
      userName: '',
    };

    async function load() {
      const stored = await chrome.storage.local.get('cs_options');
      const opts = { ...DEFAULTS, ...stored.cs_options };
      document.getElementById('api-url').value = opts.apiUrl;
      document.getElementById('max-messages').value = opts.maxMessages;
      document.getElementById('prompt-messages').value = opts.promptMessages;
      document.getElementById('user-name').value = opts.userName;
    }

    document.getElementById('btn-save').addEventListener('click', async () => {
      const opts = {
        apiUrl: document.getElementById('api-url').value.trim() || DEFAULTS.apiUrl,
        maxMessages: parseInt(document.getElementById('max-messages').value) || DEFAULTS.maxMessages,
        promptMessages: parseInt(document.getElementById('prompt-messages').value) || DEFAULTS.promptMessages,
        userName: document.getElementById('user-name').value.trim(),
      };
      await chrome.storage.local.set({ cs_options: opts });
      const status = document.getElementById('save-status');
      status.style.display = 'block';
      setTimeout(() => { status.style.display = 'none'; }, 2000);
    });

    load();
  </script>
</body>
</html>
